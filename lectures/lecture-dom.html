
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">  
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noindex, nofollow" />
    
        <title>CSCI312 Spring 2023</title>
        <meta name="description" content="CSCI312 at Middlebury College
">

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" >
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/vs2015.min.css" integrity="sha512-w8aclkBlN3Ha08SMwFKXFJqhSUx2qlvTBFLLelF8sm4xQnlg64qmGB/A6pBIKy0W8Bo51yDMDtQiPLNRq1WMcQ==" crossorigin="anonymous" />

        <link rel="stylesheet" href="/~mlinderman/courses/cs312/s23/css/main.css">
        <link rel="canonical" href="http://localhost:4000/~mlinderman/courses/cs312/s23/lectures/lecture-dom.html">
    </head>
    <body>

        <div class="container">
            <h1 id="javascript-and-the-dom">JavaScript and the DOM</h1>

<h2 id="the-document-object-model-dom">The Document Object Model (DOM)</h2>

<p>A web page (or document) is a set of (many) nested boxes, i.e. nested elements.
The DOM is a tree data structure representing the nested structure of the
document. The boxes (HTML tags in our context) are nodes in the tree. <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model">The DOM
properties and methods (the API) provide programmatic access to the tree to
access or change the document’s structure, style or
content.</a></p>

<p>More specifically JavaScript <a href="https://www.w3schools.com/js/js_htmldom.asp">can</a>:</p>
<ul>
  <li>Change all the HTML elements in the page</li>
  <li>Change all the HTML attributes in the page</li>
  <li>Change all the CSS styles in the page</li>
  <li>Remove existing HTML elements and attributes</li>
  <li>Add new HTML elements and attributes</li>
  <li>React to all existing HTML events in the page</li>
  <li>Create new HTML events in the page</li>
</ul>

<p>The root of this tree is Document. It’s child is the <code>html</code> tag, whose children
are the <code>head</code> and <code>body</code> (thus <code>head</code> and <code>body</code> are <em>siblings</em>), etc. all the
way down the leaf nodes containing text (or childless HTML elements). We can
<a href="http://eloquentjavascript.net/13_dom.html#h_ShZPVipWw/">programmatically
navigate</a> the DOM
using tree concepts like parent, children, etc.</p>

<p>As an example, navigate to the course webpage and open the <a href="https://developer.chrome.com/devtools">Chrome developer
tools</a> to the Console tab. Here we can
experiment “live” with the DOM API... Try some of the methods from the links
above, like <code>document.children</code>. For more detail about the tree-based API,
review the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Node">Node</a>,
<a href="https://developer.mozilla.org/en-US/docs/Web/API/ParentNode">ParentNode</a> and
<a href="https://developer.mozilla.org/en-US/docs/Web/API/ParentNode">ChildNode</a>
interfaces.</p>

<p>Some examples:</p>
<pre><code>&gt; document
</code></pre>

<p>Some built-in properties of <code>document</code>:</p>

<pre><code>&gt; document.head
&gt; document.body
</code></pre>

<p>Alternately we can explore via the “tree” API, e.g.</p>

<pre><code>&gt; document.children // only available on elements and only shows other elements
&gt; document.childNodes // shows all children, e.g. DOCTYPE declaration
&gt; document.lastChild.lastChild // navigate to the body element
</code></pre>

<p>It is more likely however, that we will find relevant elements based on their
type (e.g. <code>&lt;h2&gt;</code>), id, CSS class, etc. We can do so with the
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/querySelector">querySelector</a>
method that accepts CSS selector string as an argument.</p>

<p>Some example “simple” selectors: element type, #id, .class, ... Note that CSS
<a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/Introduction_to_CSS/Selectors">selectors</a>
can be quite sophisticated (with combinations of type, class, etc.), but we are
are only going to scratch the surface here.</p>

<pre><code>&gt; document.querySelectorAll("h3")
</code></pre>

<p>We can also modify these elements via JavaScript:</p>

<pre><code>&gt; document.querySelector("h2").innerHTML = "Class dismissed!"
</code></pre>

<p><em>Note that in this example, we switched from <code>querySelectorAll</code> to <code>querySelector</code>. The first returns a list, so we would have to iterate through to find the one we wanted or to change all of them. <code>querySelector</code> on the other hand, returns the first instance found on the page, which may or may not be unique.</em></p>

<p>Or in a more complex example, let’s create an announcement. We do so by
creating a DOM node and inserting into the tree (with <code>appendChild</code> or other
related methods like <code>insertBefore</code>, <code>replaceChild</code>, etc.).</p>

<pre><code>&gt; const elem = document.querySelector(".card-body");
&gt; const annc = document.createTextNode("The topic today is the DOM");
&gt; elem.appendChild(annc);
</code></pre>

<p>We can restyle elements using similar tricks:</p>

<pre><code>&gt; document.querySelector(".card-header").style.background = "red";
</code></pre>

<p>JavaScript uses an event listener model for handling interaction.  If you want
an element to respond to an event, e.g. a “click” you add an event handler to
the element. The handler is a function you would like to be invoked when the
event happens (i.e. a callback). We can do this generally with <code>addEventListener</code>,
but there are also older more specific functions for registering event
handlers, e.g. <code>onclick</code>, <code>onkeydown</code>, etc. that are widely used (we will use
<code>onclick</code> extensively with React).</p>

<pre><code>&gt; elem.onclick = (evt =&gt; alert("An emergency!"));
</code></pre>

<p>with <code>addEventListener</code>:</p>

<pre><code>&gt; elem.addEventListener("click", evt =&gt; alert("Another emergency!"))
</code></pre>

<h2 id="motivating-example-a-rgb-color-picker">Motivating Example: A RGB color picker</h2>

<p>We will create a RGB color picker similar in spirit to this
<a href="https://www.w3schools.com/colors/colors_rgb.asp">example</a>, with three sliders
(R, G and B) that control a color swatch.</p>

<p>We will eventually demonstrate many of APIs we discussed today, but let’s start
with a simple implementation in which we have statically created all of the
HTML elements, i.e. the swatch and sliders. The role for JavaScript is to
respond to <code>oninput</code> events for the slider input element by updating the color,
specifically the CSS
<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/background">background</a>
property, and the color components numeric value.</p>

<p>To do so, we will need to:</p>
<ol>
  <li>Obtain the DOM elements for the corresponding HTML elements (the swatch
<code>&lt;div&gt;</code>, slider <code>&lt;input&gt;</code>s, value <code>&lt;span&gt;</code>s) with <code>getElementById</code></li>
  <li>Create a callback function that updates the swatch background color and the
numeric values</li>
  <li>Bind the callback to the slider’s <code>oninput</code> event. Note that we purposely
choose this event instead of <code>onchange</code> (the two
<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/range">choices</a>
for <code>&lt;input type="range"&gt;</code>. The latter only “fires” when the change is
committed by the user, i.e. they release the mouse, not for all changes to
an input).</li>
</ol>

<p>Knowing that we can create HTML elements dynamically, let’s DRY up our solution
by creating the picker dynamically. Doing so is the focus of today’s <a href="practical-color-picker.html">practical
exercise</a>.</p>

        </div>

        <footer class="footer">
            <div class="container">
                <hr/ class="divider">
                <em>&copy; Michael Linderman and Christopher Andrews 2019-2023. Last modified at: 2019-02-18 22:55:18 -0500.</em>
            </div>
        </footer>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js" integrity="sha512-s+tOYYcC3Jybgr9mVsdAxsRYlGNq4mlAurOrfNuGMQ/SCofNPu92tjE7YRZCsdEtWL1yGkqk15fU/ark206YTg==" crossorigin="anonymous"></script>
        <script>
            hljs.highlightAll();
        
            const codeBlocks = document.querySelectorAll('.code-header + pre');
            const copyCodeButtons = document.querySelectorAll('.btn-clipboard');

            copyCodeButtons.forEach((copyCodeButton, index) => {
                const code = codeBlocks[index].innerText;

                copyCodeButton.addEventListener('click', () => {
                    window.navigator.clipboard.writeText(code);
                    copyCodeButton.textContent = "Copied!";
                    setTimeout(() => {
                        copyCodeButton.textContent = "Copy";
                    }, 2000);
                });
            });
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

    </body>
</html>
